"use strict";function click_video(e){var i=fn.$("ls"+e),t=i.firstElementChild;if(0==t.paused)t.insertAdjacentHTML("afterend",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="play-ico" width="1em" height="1em" viewBox="0 0 28 28"><path fill="currentColor" d="M10.138 3.382C8.304 2.31 6 3.632 6 5.756v16.489c0 2.123 2.304 3.445 4.138 2.374l14.697-8.59c1.552-.907 1.552-3.15 0-4.057z"></path></svg>'),t.pause();else{var n=i.querySelector(".play-ico");n&&(i.removeChild(n),t.play())}}function addhtml(e,i){ajax.ok({data:{fn:"note_get\\go",data:JSON.stringify({func:"to_get",pid:ini.get_count})},success:function(t){if(""!=t){t=JSON.parse(t);var n=sc_list(t,e,i);""!=n&&(ins.insertAdjacentHTML("beforebegin",n),domtop(i));for(var a=0;a<t.length;a++)video_tem.push(t[a]);if(1==e){var s=document.body.clientWidth,o=document.body.clientHeight;s==ini.sw&&o==ini.sh||(box.style.width=s+"px",box.style.height=o+"px")}}}})}function mod(e,i){return(e%i+i)%i}function sc_list(e,i,t){for(var n,a,s,o,r,d=i,c="",m=0;m<e.length;m++)n=e[m].rep_num,a=e[m].text,a=fn.tag("link",a),s=e[m].uat,o=toimg(e[m].message,e[m].lx),r={id:d,media:o,uname:s,title:a,rep_num:n},c+=fn.render(mb_ls,r),d+=1;return c}function toimg(e,t){var n='<video muted {{is_auto}} preload="true" loop=""  webkit-playsinline="true" playsinline="true" fullscreen="false" autoplay="" src="{{URL}}"></video>',a='<img class="mimg" src="{{URL}}">',s='<img class="mimg" src="https://img.youtube.com/vi/{{URL}}/0.jpg"><a class="ytbplay" href="https://www.youtube.com/watch?v={{URL}}" target="_blank">Click here to watch youtube video</a>',o="",r=e.split(",");t=t.toString();var d=(Math.floor(3*Math.random()),"");switch(1==ini.vid&&(d="autoplay muted"),t){case"1":o=a.replace("{{URL}}","http://imgcdn.herezone.com/opfile/snapfeel_groups/"+data_list[i].uat+"/"+r[0]+".webp");break;case"4":o=n.replace("{{URL}}",r[0]).replace("{{is_auto}}",d);break;case"3":o=a.replace("{{URL}}",r[0]);break;case"5":o=s.replace("{{URL}}",e).replace("{{URL}}",e)}return o}function moveto(e){var i="translate3d(0px, {q}px, 0px)".replace("{q}",0-e);bbbox.style.transform=i,console.log("moveto:---"+e)}function domtop(e){for(var i=document.querySelectorAll(".ls"),t=0;t<i.length;t++)i[t].style.top=e+"px";console.log("domto:---"+e)}function play_video(e,i){if("dw"==i){var t=fn.$("ls"+e),n=t.firstElementChild;i=n.nodeName,"VIDEO"==i?(n.muted=!1,n.currentTime=0,n.play()):"IMG"==i&&n.setAttribute("class","mimg tx-img1");var a=t.nextElementSibling,s=a.firstElementChild;"VIDEO"==s.nodeName&&s.pause()}else{var t=fn.$("ls"+e),n=t.firstElementChild;i=n.nodeName,"VIDEO"==i?(n.muted=!1,n.currentTime=0,n.play()):"IMG"==i&&n.setAttribute("class","mimg tx-img1");var o=t.previousElementSibling,r=o.firstElementChild;"VIDEO"==r.nodeName&&r.pause()}}function move_vdo(e){var i,t;if("up"==e){var n="1";if(ini.vid=ini.vid+1,ini.vid>3)if(bbbox.removeChild(bbbox.firstElementChild),t=(ini.vid-1)*ini.sh,i=(ini.vid-3)*ini.sh,4==mod(ini.vid,5)){var a=5*ini.get_count,s=a-5;ini.vid<a&&ini.vid>s?(ini.get_count=ini.get_count+1,addhtml(5*(ini.get_count-1)+1,i),moveto(t),domtop(i),n="2"):(moveto(t),domtop(i),n="4")}else moveto(t),domtop(i),n="3";else t=(ini.vid-1)*ini.sh,moveto(t),n="3";console.log("shanghua vid:"+ini.vid+"--futop:"+t+"---zitop:"+i+"--bj:"+n),play_video(ini.vid,"up")}else{if(1==ini.vid)return!1;ini.vid=ini.vid-1;var o=bbbox.firstElementChild,r=o.id.substr(2);if(ini.vid>2){t=(ini.vid-1)*ini.sh,i=(ini.vid-3)*ini.sh;var d=r-1,c=[];c.push(video_tem[d-1]),o.insertAdjacentHTML("beforebegin",sc_list(c,d,i)),moveto(t),domtop(i)}else t=(ini.vid-1)*ini.sh,i="",domtop(i),moveto(t);play_video(ini.vid,"dw"),console.log("xiahua vid:"+ini.vid+"--futop:"+t+"---zitop:"+i)}}function load(){addhtml(1,0),is_mobile()||fn.sDom({ar_pre:"1",ar_next:"1"});var e=cook.get("aname");if(e){var i=e.toLowerCase(),t="http://imgcdn.herezone.com/img/nick/"+i+".png";fn.$("add_user").src=t}}function is_mobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}var ini={vid:1,get_count:1,sw:0,sh:0},video_tem=[],ins=document.getElementById("ins"),box=document.getElementById("abox");ini.sw=document.body.clientWidth,ini.sh=document.body.clientHeight,box.style.width=ini.sw+"px",box.style.height=ini.sh+"px";var bbbox=document.getElementById("bbox"),startTime="",startDistanceX="",startDistanceY="",endTime="",endDistanceX="",endDistanceY="",moveTime="",moveDistanceX="",moveDistanceY="";box.addEventListener("touchstart",function(e){startTime=(new Date).getTime(),startDistanceX=e.touches[0].screenX,startDistanceY=e.touches[0].screenY}),box.addEventListener("touchend",function(e){endTime=(new Date).getTime(),endDistanceX=e.changedTouches[0].screenX,endDistanceY=e.changedTouches[0].screenY,moveTime=endTime-startTime,moveDistanceX=startDistanceX-endDistanceX,moveDistanceY=startDistanceY-endDistanceY,(Math.abs(moveDistanceX)>40||Math.abs(moveDistanceY)>40)&&moveTime<500?Math.abs(moveDistanceX)>Math.abs(moveDistanceY)||move_vdo(moveDistanceY>0?"up":"dw"):"VIDEO"==e.target.nodeName&&click_video(ini.vid)});var mb_ls='<div class="ls" id="ls{{id}}" style="top:{{top}}">{{media}}<div class="rmenu"><div class="mag-10-0 center"><a class="nopre" href="#"> <img id="card-upic" class="muser h-36 br-50" style="border:1px solid #fff" src="http://imgcdn.herezone.com/img/nick/{{uname}}.png"></a></div><div class="mag-10-0 center"> <img class="muchat h-30" src="/imgs/rmenu-reply.png"><div class="pad_60 fc-f center fz-14 ">{{rep_num}}</div></div><div class="mag-10-0 center"><img class="musave nopre h-30" src="/imgs/rmenu-save.png"> <div class="nopre pad_60 fc-f center fz-14 "></div></div><div class="mag-10-0 center"><img class="murepost h-30" src="/imgs/rmenu-repost.png?t=qqq"></div></div><div class="bmenu fc-f"><a class="pad_3 fc-f fw-b" href="/@{{uname}}" target="_blank">{{uname}}</a><div id="card-info" class="fs-3 fz-14">{{title}}</div></div></div>',mb_rep='<div class="replist flex  mag-t-16"> <a href="#"><img class="h-26 br-50" src="http://imgcdn.herezone.com/img/nick/{{user}}.png"></a><div class="flex-1 mag-0-10"><p class="fc-e2">Bing</p><div>{{msg}}</div><p class="fc-e2">{{addtime}}</p> </div></div>';fn.$("body").onclick=function(e){var e=e||window.event,i=e.target||e.srcElement,t=i.className;if(t){switch(t.split(" ")[0]){case"ar_pre":move_vdo("dw");break;case"ar_next":move_vdo("up");break;case"murepost":var n="https://playwant.com/post/"+video_tem[ini.vid-1].id;fn.copystr(n),fn.tips("Link copied");break;case"bjrep":var a=fn.$("ireplypost"),s=a.innerHTML,o=video_tem[ini.vid-1].id;ajax.ok({data:{fn:"note_post\\go",data:JSON.stringify({func:"to_reply",tid:o,msg:s})},success:function(e){if("1001"==e){var i=cook.get("aname");i=i.toLowerCase();var t=fn.render(mb_rep,{user:i,msg:s,addtime:"Now"});fn.$("repins").insertAdjacentHTML("beforebegin",t)}}});break;case"muser":var r=video_tem[ini.vid].uat;window.open("/@"+r);break;case"muchat":fn.sDom({repbox:"1",repchatbox:"1"});var o=video_tem[ini.vid-1].id;ajax.ok({data:{fn:"note_get\\go",data:JSON.stringify({func:"get_reply",tid:o})},success:function(e){if(""!=e){e=JSON.parse(e);for(var i="",t=0;t<e.length;t++)i+=fn.render(mb_rep,{user:e[t].uname,msg:e[t].msg,addtime:fn.u2time(e[t].add_time)});fn.$("repins").insertAdjacentHTML("beforebegin",i)}}});break;case"exitrepbox":fn.sDom({repbox:"0",repchatbox:"0"}),fn.$("rephtml").innerHTML='<p id="repins" class="no"></p>';break;case"musave":if(1!=confirm("Want to add to Favorites ?"))return!1;var o=video_tem[ini.vid-1].id;ajax.ok({data:{fn:"note_love\\go",data:JSON.stringify({func:"add_fav",tid:o})},success:function(e){"1001"==e&&fn.tips("Added to Favorites!")}})}}},load();